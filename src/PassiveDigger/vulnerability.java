/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package PassiveDigger;

import burp.BurpExtender;
import burp.IHttpRequestResponse;
import burp.IParameter;
import burp.IRequestInfo;

/**
 *
 * @author moein
 */
public class vulnerability {
    IHttpRequestResponse reqResp;
    IParameter param;
    String severity;
    String cvss;
    String code;
    String description;
    boolean server_oneTime; //vulnerabilities that needs to be checked once in server (Like Server header)
    public vulnerability(IHttpRequestResponse RequestResponse,IParameter parameter,String Vuln_severity,String Vuln_cvss,String vuln_code,String Vuln_description,boolean Vuln_ServerOneTime){
        reqResp=RequestResponse;
        param=parameter;
        severity=Vuln_severity;
        cvss=Vuln_cvss;
        code=vuln_code;
        description=Vuln_description;
        server_oneTime=Vuln_ServerOneTime;
    }
    
    public boolean equalsLevel1(vulnerability vuln2){
        if(description.equalsIgnoreCase(vuln2.getDescription())){
            if(Functions.getURL(reqResp).getHost().equals(Functions.getURL(vuln2.getReqResp()).getHost())){
                return true;
            }
            
        }
        return false;
    }
    
    public boolean equalsLevel2(vulnerability vuln2){
        IRequestInfo reqInfo1=BurpExtender.callbacks.getHelpers().analyzeRequest(reqResp);
        IRequestInfo reqInfo2 = BurpExtender.callbacks.getHelpers().analyzeRequest(vuln2.reqResp);
        if (description.equalsIgnoreCase(vuln2.getDescription())) {
            if (Functions.getURL(reqResp).getHost().equals(Functions.getURL(vuln2.getReqResp()).getHost())) {
                if (reqInfo1.getUrl().toString().equalsIgnoreCase(reqInfo2.getUrl().toString())) {
                    if (param != null) {
                        if (param.getName().equalsIgnoreCase(vuln2.param.getName())) {
                            return true;
                        }
                    } else {
                        return true;
                    }
                }
            }
            
        }
        return false;
    }
    
    public IHttpRequestResponse getReqResp(){
        return reqResp;
    }
    
    public IParameter getParameter(){
        return param;
    }
    
    public String getDescription(){
        return description;
    }
    
    public String getCVSS(){
        return cvss;
    }
    
    public String getSeverity(){
        return severity;
    }
    
    public String getCode(){
        return code;
    }
    
    
}
